# SuKaAI 功能规划与 Issue 列表

## 📋 基础功能完善 (Foundation Enhancement)

### 🔴 高优先级 - 核心功能完善

#### Issue #1: 完善对话历史持久化
**优先级**: 🔴 High  
**标签**: `enhancement`, `database`, `core`

**描述**:
- 将对话历史保存到 Supabase 数据库
- 实现对话会话管理（创建、切换、删除会话）
- 支持对话历史搜索和过滤
- 实现对话导出功能

**任务清单**:
- [ ] 创建 `conversations` 表（会话表）
- [ ] 创建 `messages` 表（消息表）
- [ ] 实现对话保存 API (`/api/conversations`)
- [ ] 实现对话加载功能
- [ ] 添加会话列表 UI 组件
- [ ] 实现会话切换功能
- [ ] 添加对话搜索功能

**技术要点**:
- 使用 Supabase 存储对话数据
- 实现分页加载（避免一次性加载所有历史）
- 支持消息编辑和删除

---

#### Issue #2: 实现用户设置和偏好管理
**优先级**: 🔴 High  
**标签**: `enhancement`, `user-settings`, `core`

**描述**:
- 创建用户设置页面
- 实现知识缺口分析阈值配置
- 支持平台特定的 SOP 提示词管理
- 语言偏好设置

**任务清单**:
- [ ] 创建用户设置页面 (`/app/settings/page.tsx`)
- [ ] 实现设置保存 API (`/api/user/settings`)
- [ ] 添加知识缺口阈值滑块
- [ ] 实现平台提示词编辑器
- [ ] 添加语言选择器
- [ ] 实现自动生成开关

**技术要点**:
- 使用 `user_preferences` 表存储设置
- 实时同步设置到后端
- 表单验证和错误处理

---

#### Issue #3: 完善错误处理和用户反馈
**优先级**: 🔴 High  
**标签**: `enhancement`, `error-handling`, `ux`

**描述**:
- 实现全局错误边界
- 添加友好的错误提示组件
- 实现错误日志记录
- 添加重试机制

**任务清单**:
- [ ] 创建 ErrorBoundary 组件
- [ ] 实现 Toast 通知系统
- [ ] 添加 API 错误处理中间件
- [ ] 实现自动重试逻辑
- [ ] 添加错误上报功能（可选）

**技术要点**:
- 使用 React Error Boundary
- 集成 toast 库（如 sonner）
- 区分网络错误、API 错误、业务错误

---

#### Issue #4: 实现 RAG 检索功能
**优先级**: 🔴 High  
**标签**: `feature`, `rag`, `ai`, `core`

**描述**:
- 集成向量搜索到对话系统
- 实现上下文注入到 LLM
- 支持引用来源显示
- 优化检索质量

**任务清单**:
- [ ] 实现向量搜索 API (`/api/search/vector`)
- [ ] 在对话 API 中集成 RAG
- [ ] 实现引用来源追踪
- [ ] 添加来源显示组件
- [ ] 优化检索 prompt
- [ ] 实现检索结果排序

**技术要点**:
- 使用 Supabase pgvector 进行相似度搜索
- 实现混合检索（向量 + 关键词）
- 支持多轮对话的上下文管理

---

### 🟡 中优先级 - 体验优化

#### Issue #5: 实现对话消息操作功能
**优先级**: 🟡 Medium  
**标签**: `enhancement`, `ui`, `chat`

**描述**:
- 消息复制功能
- 消息重新生成
- 消息编辑和删除
- 消息点赞/反馈

**任务清单**:
- [ ] 添加消息操作菜单（右键/长按）
- [ ] 实现复制到剪贴板
- [ ] 实现消息重新生成
- [ ] 添加编辑和删除功能
- [ ] 实现反馈按钮（👍/👎）
- [ ] 保存用户反馈到数据库

---

#### Issue #6: 实现对话导出和分享
**优先级**: 🟡 Medium  
**标签**: `feature`, `export`, `sharing`

**描述**:
- 导出对话为 Markdown
- 导出对话为 PDF
- 生成分享链接
- 支持对话打印

**任务清单**:
- [ ] 实现 Markdown 导出
- [ ] 实现 PDF 导出（使用 jsPDF 或类似库）
- [ ] 创建分享链接生成功能
- [ ] 添加打印样式
- [ ] 实现导出历史记录

---

#### Issue #7: 优化输入框功能
**优先级**: 🟡 Medium  
**标签**: `enhancement`, `ui`, `input`

**描述**:
- 实现 @ 提及功能
- 实现 / 快捷命令
- 支持多行输入
- 添加输入历史记录

**任务清单**:
- [ ] 实现 @ 提及自动完成
- [ ] 实现 / 命令菜单
- [ ] 支持 Shift+Enter 换行
- [ ] 添加上下箭头浏览历史
- [ ] 实现输入建议功能

---

## 🚀 新功能规划 (New Features)

### Issue #8: 实现 Radar Agent - 情报采集模块
**优先级**: 🔴 High  
**标签**: `feature`, `radar-agent`, `data-collection`

**描述**:
实现 Radar Agent 的核心功能：从多个来源自动采集和清洗内容。

**功能需求**:
- YouTube 视频内容采集
- Twitter/X 内容采集
- RSS 订阅源支持
- 内容去噪和预处理
- IMR（中间元数据表示）映射

**任务清单**:
- [ ] 实现 YouTube API 集成
- [ ] 实现 Twitter API 集成
- [ ] 实现 RSS 解析器
- [ ] 实现内容去噪算法
- [ ] 实现 IMR 映射逻辑
- [ ] 创建内容源管理 UI
- [ ] 实现定时采集 Cron 任务
- [ ] 添加采集状态监控

**技术要点**:
- 使用 `youtube-transcript-api` 提取字幕
- 实现 LLM 驱动的去噪过滤
- 设计 IMR 数据结构
- 实现增量采集（只采集新内容）

---

### Issue #9: 实现 Brain Agent - 知识缺口分析
**优先级**: 🔴 High  
**标签**: `feature`, `brain-agent`, `ai`, `recommendation`

**描述**:
实现基于向量空间的知识缺口分析，提供个性化内容推荐。

**功能需求**:
- 向量嵌入生成
- 知识库向量管理
- 知识缺口计算算法
- 个性化推荐生成
- 推荐理由解释

**任务清单**:
- [ ] 实现向量嵌入生成 API
- [ ] 实现用户知识库向量存储
- [ ] 实现知识缺口分析算法
- [ ] 实现推荐生成逻辑
- [ ] 创建推荐展示 UI
- [ ] 实现推荐反馈机制（RLHF）
- [ ] 添加推荐质量评估

**技术要点**:
- 使用 OpenAI `text-embedding-3-small` 模型
- 实现余弦相似度计算
- 设计阈值动态调整机制
- 实现推荐排序算法

---

### Issue #10: 实现 Matrix Agent - 内容生成模块
**优先级**: 🔴 High  
**标签**: `feature`, `matrix-agent`, `content-generation`

**描述**:
实现跨平台内容生成，支持多种社交媒体平台的自适应内容创作。

**功能需求**:
- 平台特定内容生成
- 风格迁移功能
- 时间锚点保留
- 视觉关键词提取
- 内容预览和编辑

**任务清单**:
- [ ] 实现平台提示词系统
- [ ] 实现内容生成 API
- [ ] 实现风格迁移算法
- [ ] 实现时间锚点提取和保留
- [ ] 创建内容编辑器组件
- [ ] 实现内容预览功能
- [ ] 添加内容发布功能（可选）

**技术要点**:
- 设计 Prompt Chain 架构
- 实现多步骤生成流程
- 支持内容草稿保存
- 实现内容版本管理

---

### Issue #11: 实现 Discover 页面 - 内容发现
**优先级**: 🟡 Medium  
**标签**: `feature`, `discover`, `ui`

**描述**:
创建内容发现页面，展示推荐内容和知识缺口分析结果。

**功能需求**:
- 推荐内容卡片展示
- 知识缺口可视化
- 内容分类和过滤
- 内容详情页面
- 快速操作（收藏、生成内容）

**任务清单**:
- [ ] 设计 Discover 页面布局
- [ ] 实现推荐内容列表
- [ ] 实现知识缺口可视化图表
- [ ] 添加内容分类筛选
- [ ] 创建内容详情模态框
- [ ] 实现快速操作按钮
- [ ] 添加无限滚动加载

---

### Issue #12: 实现 Spaces 页面 - 内容空间管理
**优先级**: 🟡 Medium  
**标签**: `feature`, `spaces`, `organization`

**描述**:
实现内容空间管理功能，允许用户组织和分类内容。

**功能需求**:
- 创建和管理内容空间
- 内容分类和标签
- 空间内内容搜索
- 空间分享功能
- 空间统计和分析

**任务清单**:
- [ ] 设计 Spaces 页面布局
- [ ] 实现空间创建和管理
- [ ] 实现内容分类系统
- [ ] 添加标签管理功能
- [ ] 实现空间内搜索
- [ ] 添加空间统计面板
- [ ] 实现空间分享功能

---

### Issue #13: 实现用户仪表板 (Dashboard)
**优先级**: 🟡 Medium  
**标签**: `feature`, `dashboard`, `analytics`

**描述**:
创建用户仪表板，展示使用统计和洞察。

**功能需求**:
- 使用统计图表
- 知识增长可视化
- 内容生成历史
- 推荐效果分析
- 快速操作入口

**任务清单**:
- [ ] 设计 Dashboard 布局
- [ ] 实现统计数据 API
- [ ] 创建图表组件（使用 recharts 或类似）
- [ ] 实现知识增长曲线
- [ ] 添加快速操作卡片
- [ ] 实现数据导出功能

---

### Issue #14: 实现多语言支持 (i18n)
**优先级**: 🟢 Low  
**标签**: `feature`, `i18n`, `localization`

**描述**:
添加多语言支持，支持中英文切换。

**任务清单**:
- [ ] 集成 next-intl 或类似库
- [ ] 创建语言文件（zh-CN, en-US）
- [ ] 实现语言切换功能
- [ ] 翻译所有 UI 文本
- [ ] 实现语言偏好持久化

---

### Issue #15: 实现暗色模式 (Dark Mode)
**优先级**: 🟢 Low  
**标签**: `feature`, `ui`, `theme`

**描述**:
添加暗色模式支持，提升用户体验。

**任务清单**:
- [ ] 设计暗色模式配色方案
- [ ] 实现主题切换功能
- [ ] 添加主题持久化
- [ ] 更新所有组件支持暗色模式
- [ ] 实现系统主题检测

---

## 🔧 技术债务 (Technical Debt)

### Issue #16: 优化 API 性能和错误处理
**优先级**: 🟡 Medium  
**标签**: `refactor`, `performance`, `api`

**任务清单**:
- [ ] 实现 API 请求缓存
- [ ] 添加请求去重机制
- [ ] 优化数据库查询性能
- [ ] 实现 API 限流
- [ ] 添加请求监控和日志

---

### Issue #17: 完善测试覆盖
**优先级**: 🟡 Medium  
**标签**: `testing`, `quality`

**任务清单**:
- [ ] 添加单元测试（Jest + React Testing Library）
- [ ] 添加 API 集成测试
- [ ] 添加 E2E 测试（Playwright）
- [ ] 实现 CI/CD 测试流程
- [ ] 添加代码覆盖率报告

---

### Issue #18: 优化 SEO 和元数据
**优先级**: 🟢 Low  
**标签**: `seo`, `meta`

**任务清单**:
- [ ] 添加页面元数据
- [ ] 实现 Open Graph 标签
- [ ] 添加结构化数据（JSON-LD）
- [ ] 优化页面性能（Lighthouse）
- [ ] 实现 sitemap 生成

---

## 📊 优先级总结

### 🔴 高优先级（立即开始）
1. Issue #1: 对话历史持久化
2. Issue #2: 用户设置管理
3. Issue #3: 错误处理完善
4. Issue #4: RAG 检索功能
5. Issue #8: Radar Agent 实现
6. Issue #9: Brain Agent 实现
7. Issue #10: Matrix Agent 实现

### 🟡 中优先级（近期规划）
- Issue #5: 消息操作功能
- Issue #6: 对话导出分享
- Issue #7: 输入框优化
- Issue #11: Discover 页面
- Issue #12: Spaces 页面
- Issue #13: 用户仪表板

### 🟢 低优先级（后续优化）
- Issue #14: 多语言支持
- Issue #15: 暗色模式
- Issue #16: 性能优化
- Issue #17: 测试覆盖
- Issue #18: SEO 优化

---

## 📝 Issue 模板

使用以下格式在 GitHub 创建 Issue：

```markdown
## 功能描述
[简要描述功能]

## 任务清单
- [ ] 任务 1
- [ ] 任务 2
- [ ] 任务 3

## 技术要点
- 技术点 1
- 技术点 2

## 验收标准
- [ ] 标准 1
- [ ] 标准 2

## 相关 Issue
- #相关issue编号
```
